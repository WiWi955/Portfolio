<!DOCTYPE html><html lang="en" data-astro-cid-37fxchfa> <head><meta charset="UTF-8"><meta name="description" property="og:description" content="Solution audio complète avec gestion de playlists et téléchargement YouTube intégré
"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.2.5"><title>Downloader youtube &amp; Lecteur Audio en Python</title><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,400;0,700;1,400&family=Rubik:wght@500;600&display=swap" rel="stylesheet"><script>
	// This code is inlined in the head to make dark mode instant & blocking.
	const getThemePreference = () => {
		if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
			return localStorage.getItem('theme');
		}
		return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
	};
	const isDark = getThemePreference() === 'dark';
	document.documentElement.classList[isDark ? 'add' : 'remove']('theme-dark');

	if (typeof localStorage !== 'undefined') {
		// Watch the document element and persist user preference when it changes.
		const observer = new MutationObserver(() => {
			const isDark = document.documentElement.classList.contains('theme-dark');
			localStorage.setItem('theme', isDark ? 'dark' : 'light');
		});
		observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
	}
</script><link rel="stylesheet" href="/_astro/about.D77XyGNg.css">
<style>a[data-astro-cid-balv45lp]{position:relative;display:flex;place-content:center;text-align:center;padding:.56em 2em;gap:.8em;color:var(--accent-text-over);text-decoration:none;line-height:1.1;border-radius:999rem;overflow:hidden;background:var(--gradient-accent-orange);box-shadow:var(--shadow-md);white-space:nowrap}@media (min-width: 20em){a[data-astro-cid-balv45lp]{font-size:var(--text-lg)}}a[data-astro-cid-balv45lp]:after{content:"";position:absolute;inset:0;pointer-events:none;transition:background-color var(--theme-transition);mix-blend-mode:overlay}a[data-astro-cid-balv45lp]:focus:after,a[data-astro-cid-balv45lp]:hover:after{background-color:hsla(var(--gray-999-basis),.3)}@media (min-width: 50em){a[data-astro-cid-balv45lp]{padding:1.125rem 2.5rem;font-size:var(--text-xl)}}aside[data-astro-cid-rcdzuq3a]{display:flex;flex-direction:column;align-items:center;gap:3rem;border-top:1px solid var(--gray-800);border-bottom:1px solid var(--gray-800);padding:5rem 1.5rem;background-color:var(--gray-999_40);box-shadow:var(--shadow-sm)}h2[data-astro-cid-rcdzuq3a]{font-size:var(--text-xl);text-align:center;max-width:15ch}@media (min-width: 50em){aside[data-astro-cid-rcdzuq3a]{padding:7.5rem;flex-direction:row;flex-wrap:wrap;justify-content:space-between}h2[data-astro-cid-rcdzuq3a]{font-size:var(--text-3xl);text-align:left}}
svg[data-astro-cid-patnjmll]{vertical-align:middle;width:var(--size, 1em);height:var(--size, 1em)}
.pill[data-astro-cid-2qeywk4b]{display:flex;padding:.5rem 1rem;gap:.5rem;color:var(--accent-text-over);border:1px solid var(--accent-regular);background-color:var(--accent-regular);border-radius:999rem;font-size:var(--text-md);line-height:1.35;white-space:nowrap}
header[data-astro-cid-qwekciqp]{padding-bottom:2.5rem;border-bottom:1px solid var(--gray-800)}.back-link[data-astro-cid-qwekciqp]{display:none}.details[data-astro-cid-qwekciqp]{display:flex;flex-direction:column;padding:.5rem;gap:1.5rem;justify-content:space-between;align-items:center}.tags[data-astro-cid-qwekciqp]{display:flex;gap:.5rem}.description[data-astro-cid-qwekciqp]{font-size:var(--text-lg);max-width:54ch}.content[data-astro-cid-qwekciqp]{max-width:65ch;margin-inline:auto}.content[data-astro-cid-qwekciqp]>*+*{margin-top:1rem}.content[data-astro-cid-qwekciqp] h1,.content[data-astro-cid-qwekciqp] h2,.content[data-astro-cid-qwekciqp] h3,.content[data-astro-cid-qwekciqp] h4,.content[data-astro-cid-qwekciqp] h5{margin:1.5rem 0}.content[data-astro-cid-qwekciqp] img{border-radius:1.5rem;box-shadow:var(--shadow-sm);background:var(--gradient-subtle);border:1px solid var(--gray-800)}.content[data-astro-cid-qwekciqp] blockquote{font-size:var(--text-lg);font-family:var(--font-brand);font-weight:600;line-height:1.1;padding-inline-start:1.5rem;border-inline-start:.25rem solid var(--accent-dark);color:var(--gray-0)}.back-link[data-astro-cid-qwekciqp],.content[data-astro-cid-qwekciqp] a{text-decoration:1px solid underline transparent;text-underline-offset:.25em;transition:text-decoration-color var(--theme-transition)}.back-link[data-astro-cid-qwekciqp]:hover,.back-link[data-astro-cid-qwekciqp]:focus,.content[data-astro-cid-qwekciqp] a:hover,.content[data-astro-cid-qwekciqp] a:focus{text-decoration-color:currentColor}@media (min-width: 50em){.back-link[data-astro-cid-qwekciqp]{display:block;align-self:flex-start}.details[data-astro-cid-qwekciqp]{flex-direction:row;gap:2.5rem}.content[data-astro-cid-qwekciqp] blockquote{font-size:var(--text-2xl)}}
</style></head> <body data-astro-cid-37fxchfa> <div class="stack backgrounds" data-astro-cid-37fxchfa> <nav data-astro-cid-dmqpwcec> <div class="menu-header" data-astro-cid-dmqpwcec> <a href="/" class="site-title" data-astro-cid-dmqpwcec> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="url(#icon-gradient-2xo707pog)" fill="url(#icon-gradient-2xo707pog)" style="--size:1.6em" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="m80 96 40 32-40 32m56 0h40"/><rect width="192" height="160" x="32" y="48" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16.97" rx="8.5"/></g> <linearGradient id="icon-gradient-2xo707pog" x1="23" x2="235" y1="43" y2="202" gradientUnits="userSpaceOnUse" data-astro-cid-patnjmll> <stop stop-color="var(--gradient-stop-1)" data-astro-cid-patnjmll></stop> <stop offset=".5" stop-color="var(--gradient-stop-2)" data-astro-cid-patnjmll></stop> <stop offset="1" stop-color="var(--gradient-stop-3)" data-astro-cid-patnjmll></stop> </linearGradient> </svg> 
William NGUYEN
</a> <menu-button data-astro-cid-dmqpwcec="true"> <template data-astro-cid-dmqpwcec> <button class="menu-button" aria-expanded="false" data-astro-cid-dmqpwcec> <span class="sr-only" data-astro-cid-dmqpwcec>Menu</span> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M40 128h176M40 64h176M40 192h176"/></g>  </svg>  </button> </template> </menu-button> </div> <noscript> <ul class="nav-items" data-astro-cid-dmqpwcec> <li data-astro-cid-dmqpwcec> <a class="link" href="/" data-astro-cid-dmqpwcec> Accueil </a> </li><li data-astro-cid-dmqpwcec> <a aria-current="page" class="link" href="/work/" data-astro-cid-dmqpwcec> Projets </a> </li><li data-astro-cid-dmqpwcec> <a class="link" href="/veille/" data-astro-cid-dmqpwcec> Veille </a> </li><li data-astro-cid-dmqpwcec> <a class="link" href="/about/" data-astro-cid-dmqpwcec> parcours </a> </li> </ul> </noscript> <noscript> <div class="menu-footer" data-astro-cid-dmqpwcec> <div class="socials" data-astro-cid-dmqpwcec> <a href="https://www.linkedin.com/in/william-nguyen-214018276/" class="social" data-astro-cid-dmqpwcec> <span class="sr-only" data-astro-cid-dmqpwcec>LinkedIn</span> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><rect width="184" height="184" x="36" y="36" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" rx="8"/><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M120 112v64m-32-64v64m32-36a28 28 0 0 1 56 0v36"/><circle stroke="none" cx="88" cy="80" r="12"/></g>  </svg>  </a><a href="https://github.com/WiWi955" class="social" data-astro-cid-dmqpwcec> <span class="sr-only" data-astro-cid-dmqpwcec>GitHub</span> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><g stroke-linecap="round" stroke-linejoin="round"><path fill="none" stroke-width="14.7" d="M55.7 167.2c13.9 1 21.3 13.1 22.2 14.6 4.2 7.2 10.4 9.6 18.3 7.1l1.1-3.4a60.3 60.3 0 0 1-25.8-11.9c-12-10.1-18-25.6-18-46.3"/><path fill="none" stroke-width="16" d="M61.4 205.1a24.5 24.5 0 0 1-3-6.1c-3.2-7.9-7.1-10.6-7.8-11.1l-1-.6c-2.4-1.6-9.5-6.5-7.2-13.9 1.4-4.5 6-7.2 12.3-7.2h.8c4 .3 7.6 1.5 10.7 3.2-9.1-10.1-13.6-24.3-13.6-42.3 0-11.3 3.5-21.7 10.1-30.4A46.7 46.7 0 0 1 65 67.3a8.3 8.3 0 0 1 5-4.7c2.8-.9 13.3-2.7 33.2 9.9a105 105 0 0 1 50.5 0c19.9-12.6 30.4-10.8 33.2-9.9 2.3.7 4.1 2.4 5 4.7 5 12.7 4 23.2 2.6 29.4 6.7 8.7 10 18.9 10 30.4 0 42.6-25.8 54.7-43.6 58.7 1.4 4.1 2.2 8.8 2.2 13.7l-.1 23.4v2.3"/><path fill="none" stroke-width="16" d="M160.9 185.7c1.4 4.1 2.2 8.8 2.2 13.7l-.1 23.4v2.3A98.6 98.6 0 1 0 61.4 205c-1.4-2.1-11.3-17.5-11.8-17.8-2.4-1.6-9.5-6.5-7.2-13.9 1.4-4.5 6-7.2 12.3-7.2h.8c4 .3 7.6 1.5 10.7 3.2-9.1-10.1-13.6-24.3-13.6-42.3 0-11.3 3.5-21.7 10.1-30.4A46.4 46.4 0 0 1 65 67.3a8.3 8.3 0 0 1 5-4.7c2.8-.9 13.3-2.7 33.2 9.9a105 105 0 0 1 50.5 0c19.9-12.6 30.4-10.8 33.2-9.9 2.3.7 4.1 2.4 5 4.7 5 12.7 4 23.2 2.6 29.4 6.7 8.7 10 18.9 10 30.4.1 42.6-25.8 54.7-43.6 58.6z"/><path fill="none" stroke-width="18.7" d="m170.1 203.3 17.3-12 17.2-18.7 9.5-26.6v-27.9l-9.5-27.5" /><path fill="none" stroke-width="22.7" d="m92.1 57.3 23.3-4.6 18.7-1.4 29.3 5.4m-110 32.6-8 16-4 21.4.6 20.3 3.4 13" /><path fill="none" stroke-width="13.3" d="M28.8 133a100 100 0 0 0 66.9 94.4v-8.7c-22.4 1.8-33-11.5-35.6-19.8-3.4-8.6-7.8-11.4-8.5-11.8"/></g></g>  </svg>  </a> </div> </div> </noscript> <div id="menu-content" hidden data-astro-cid-dmqpwcec> <ul class="nav-items" data-astro-cid-dmqpwcec> <li data-astro-cid-dmqpwcec> <a class="link" href="/" data-astro-cid-dmqpwcec> Accueil </a> </li><li data-astro-cid-dmqpwcec> <a aria-current="page" class="link" href="/work/" data-astro-cid-dmqpwcec> Projets </a> </li><li data-astro-cid-dmqpwcec> <a class="link" href="/veille/" data-astro-cid-dmqpwcec> Veille </a> </li><li data-astro-cid-dmqpwcec> <a class="link" href="/about/" data-astro-cid-dmqpwcec> parcours </a> </li> </ul> <div class="menu-footer" data-astro-cid-dmqpwcec> <div class="socials" data-astro-cid-dmqpwcec> <a href="https://www.linkedin.com/in/william-nguyen-214018276/" class="social" data-astro-cid-dmqpwcec> <span class="sr-only" data-astro-cid-dmqpwcec>LinkedIn</span> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><rect width="184" height="184" x="36" y="36" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" rx="8"/><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M120 112v64m-32-64v64m32-36a28 28 0 0 1 56 0v36"/><circle stroke="none" cx="88" cy="80" r="12"/></g>  </svg>  </a><a href="https://github.com/WiWi955" class="social" data-astro-cid-dmqpwcec> <span class="sr-only" data-astro-cid-dmqpwcec>GitHub</span> <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><g stroke-linecap="round" stroke-linejoin="round"><path fill="none" stroke-width="14.7" d="M55.7 167.2c13.9 1 21.3 13.1 22.2 14.6 4.2 7.2 10.4 9.6 18.3 7.1l1.1-3.4a60.3 60.3 0 0 1-25.8-11.9c-12-10.1-18-25.6-18-46.3"/><path fill="none" stroke-width="16" d="M61.4 205.1a24.5 24.5 0 0 1-3-6.1c-3.2-7.9-7.1-10.6-7.8-11.1l-1-.6c-2.4-1.6-9.5-6.5-7.2-13.9 1.4-4.5 6-7.2 12.3-7.2h.8c4 .3 7.6 1.5 10.7 3.2-9.1-10.1-13.6-24.3-13.6-42.3 0-11.3 3.5-21.7 10.1-30.4A46.7 46.7 0 0 1 65 67.3a8.3 8.3 0 0 1 5-4.7c2.8-.9 13.3-2.7 33.2 9.9a105 105 0 0 1 50.5 0c19.9-12.6 30.4-10.8 33.2-9.9 2.3.7 4.1 2.4 5 4.7 5 12.7 4 23.2 2.6 29.4 6.7 8.7 10 18.9 10 30.4 0 42.6-25.8 54.7-43.6 58.7 1.4 4.1 2.2 8.8 2.2 13.7l-.1 23.4v2.3"/><path fill="none" stroke-width="16" d="M160.9 185.7c1.4 4.1 2.2 8.8 2.2 13.7l-.1 23.4v2.3A98.6 98.6 0 1 0 61.4 205c-1.4-2.1-11.3-17.5-11.8-17.8-2.4-1.6-9.5-6.5-7.2-13.9 1.4-4.5 6-7.2 12.3-7.2h.8c4 .3 7.6 1.5 10.7 3.2-9.1-10.1-13.6-24.3-13.6-42.3 0-11.3 3.5-21.7 10.1-30.4A46.4 46.4 0 0 1 65 67.3a8.3 8.3 0 0 1 5-4.7c2.8-.9 13.3-2.7 33.2 9.9a105 105 0 0 1 50.5 0c19.9-12.6 30.4-10.8 33.2-9.9 2.3.7 4.1 2.4 5 4.7 5 12.7 4 23.2 2.6 29.4 6.7 8.7 10 18.9 10 30.4.1 42.6-25.8 54.7-43.6 58.6z"/><path fill="none" stroke-width="18.7" d="m170.1 203.3 17.3-12 17.2-18.7 9.5-26.6v-27.9l-9.5-27.5" /><path fill="none" stroke-width="22.7" d="m92.1 57.3 23.3-4.6 18.7-1.4 29.3 5.4m-110 32.6-8 16-4 21.4.6 20.3 3.4 13" /><path fill="none" stroke-width="13.3" d="M28.8 133a100 100 0 0 0 66.9 94.4v-8.7c-22.4 1.8-33-11.5-35.6-19.8-3.4-8.6-7.8-11.4-8.5-11.8"/></g></g>  </svg>  </a> </div> <div class="theme-toggle" data-astro-cid-dmqpwcec> <theme-toggle data-astro-cid-x3pjskd3="true"> <button data-astro-cid-x3pjskd3> <span class="sr-only" data-astro-cid-x3pjskd3>Dark theme</span> <span class="icon light" data-astro-cid-x3pjskd3><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><circle cx="128" cy="128" r="60" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M128 36V16M63 63 49 49m-13 79H16m47 65-14 14m79 13v20m65-47 14 14m13-79h20m-47-65 14-14"/></g>  </svg> </span> <span class="icon dark" data-astro-cid-x3pjskd3><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M216 112V64m24 24h-48m-24-64v32m16-16h-32m65 113A92 92 0 0 1 103 39h0a92 92 0 1 0 114 114Z"/></g>  </svg> </span> </button> </theme-toggle>  <script type="module">class n extends HTMLElement{constructor(){super();const e=this.querySelector("button"),t=s=>{document.documentElement.classList[s?"add":"remove"]("theme-dark"),e.setAttribute("aria-pressed",String(s))};e.addEventListener("click",()=>t(!this.isDark())),t(this.isDark())}isDark(){return document.documentElement.classList.contains("theme-dark")}}customElements.define("theme-toggle",n);</script> </div> </div> </div> </nav> <script type="module">class i extends HTMLElement{constructor(){super(),this.appendChild(this.querySelector("template").content.cloneNode(!0));const n=this.querySelector("button"),t=document.getElementById("menu-content");t.hidden=!0,t.classList.add("menu-content");const d=e=>{n.setAttribute("aria-expanded",e?"true":"false"),t.hidden=!e};n.addEventListener("click",()=>d(t.hidden));const s=e=>{d(e.matches),n.hidden=e.matches},c=window.matchMedia("(min-width: 50em)");s(c),c.addEventListener("change",s)}}customElements.define("menu-button",i);</script>   <div class="stack gap-20" data-astro-cid-qwekciqp> <div class="stack gap-15" data-astro-cid-qwekciqp> <header data-astro-cid-qwekciqp> <div class="wrapper stack gap-2" data-astro-cid-qwekciqp> <a class="back-link" href="/work/" data-astro-cid-qwekciqp><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M216 128H40m72-72-72 72 72 72"/></g>  </svg>  Work</a> <div class="hero stack gap-4 start" data-astro-cid-bbe6dxrz> <div class="stack gap-2" data-astro-cid-bbe6dxrz> <h1 class="title" data-astro-cid-bbe6dxrz>Downloader youtube &amp; Lecteur Audio en Python</h1>  </div>  <div class="details" data-astro-cid-qwekciqp> <div class="tags" data-astro-cid-qwekciqp> <div class="pill" data-astro-cid-2qeywk4b>Python</div> <div class="pill" data-astro-cid-2qeywk4b>Audio</div> <div class="pill" data-astro-cid-2qeywk4b>Downloader</div> <div class="pill" data-astro-cid-2qeywk4b>Optimisation</div>  </div> <p class="description" data-astro-cid-qwekciqp>Solution audio complète avec gestion de playlists et téléchargement YouTube intégré
</p> </div>  </div>  </div> </header> <main class="wrapper" data-astro-cid-qwekciqp> <div class="stack gap-10 content" data-astro-cid-qwekciqp> <img src="/assets/player-interface.jpg" alt="Interface du lecteur personnalisé" data-astro-cid-qwekciqp> <div class="content" data-astro-cid-qwekciqp> <!-- Formulaire de mot de passe -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const correctPassword = "0955"; // Remplacez par votre mot de passe
    const passwordForm = document.getElementById('password-form');
    const content = document.getElementById('content');
    const passwordProtected = document.getElementById('password-protected');

    passwordForm.addEventListener('submit', function(event) {
      event.preventDefault();
      const enteredPassword = document.getElementById('password').value;

      if (enteredPassword === correctPassword) {
        content.style.display = 'block';
        passwordProtected.style.display = 'none';
      } else {
        alert('Mot de passe incorrect');
      }
    });
  });
</script>
<!-- Styles pour harmoniser le formulaire -->
<style>
#password-protected {
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: transparent; /* Utiliser rgba pour la transparence */
}

  
  #password-form {
    background: #fff;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  
  #password-form label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
  }
  
  #password-form input[type="password"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 20px; /* Bordures arrondies */
    background-color: transparent; /* Fond transparent */
  }
  
  #password-form button {
    background-color: #7611a6;
    color: white;
    padding: 10px 20px;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
  }
  
  #password-form button:hover {
    background-color: #520873;
  }
</style>
<!-- Contenu masqué initialement -->
<div id="password-protected">
  <form id="password-form">
    <label for="password">Entrez le mot de passe :</label>
    <input type="password" id="password">
    <button type="submit">Soumettre</button>
  </form>
</div>
<div id="content" style="display: none;">
<h1 id="-code-complet-du-lecteur-audio">🎵 Code Complet du Lecteur Audio</h1>
<hr>
<h2 id="à-propos-du-programme">À propos du programme</h2>
<p>Ce programme est une solution tout-en-un pour écouter et gérer des fichiers audio tout en offrant un système de téléchargement intégré. Il permet aux utilisateurs de créer et organiser leurs playlists, d’afficher les pochettes d’album et de télécharger des fichiers audio directement depuis YouTube grâce à yt-dlp. L’interface utilisateur est optimisée pour une navigation fluide et une faible consommation mémoire.</p>
<p>Grâce à ses nombreuses fonctionnalités, le lecteur audio constitue une alternative efficace aux services de streaming tout en garantissant un contrôle total sur la bibliothèque musicale de l’utilisateur.</p>
<hr>
<h2 id="motivation-du-projet">Motivation du Projet</h2>
<p><strong>Problématiques résolues</strong> :</p>
<ul>
<li>Alternative gratuite à Spotify Premium</li>
<li>Réduction de la consommation mémoire (-70%)</li>
<li>Contrôle total des fonctionnalités</li>
</ul>
<hr>
<h2 id="architecture-globale">Architecture Globale</h2>
<p><strong>Structure technique</strong> :</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>lecteur-spotify/</span></span>
<span class="line"><span>├── audio/           # Fichiers MP3</span></span>
<span class="line"><span>├── Pochette_album/  # Miniatures</span></span>
<span class="line"><span>├── img/             # Icônes UI</span></span>
<span class="line"><span>├── app_data.json    # Configuration</span></span>
<span class="line"><span>└── Downloader.py    # Code principal</span></span></code></pre>
<hr>
<h2 id="dépendances-clés">Dépendances Clés</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6A737D"># requirements.txt</span></span>
<span class="line"><span style="color:#E1E4E8">customtkinter</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=5.2.1</span></span>
<span class="line"><span style="color:#E1E4E8">yt-dlp</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=2023.11.16</span></span>
<span class="line"><span style="color:#E1E4E8">pillow</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=10.0.1</span></span>
<span class="line"><span style="color:#E1E4E8">pygame</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=2.5.2</span></span>
<span class="line"><span style="color:#E1E4E8">mutagen</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=1.47.0</span></span>
<span class="line"><span style="color:#E1E4E8">requests</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">=2.31.0</span></span></code></pre>
<hr>
<h2 id="optimisations-mémoire">Optimisations Mémoire</h2>
<p><strong>Techniques utilisées</strong> :</p>
<ol>
<li>Chargement asynchrone des ressources</li>
<li>Garbage Collection manuel</li>
<li>Pool de threads limité</li>
<li>Cache intelligent</li>
</ol>
<p><strong>Exemple d’optimisation</strong> :</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_library_view</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#6A737D">    # Chargement lazy des images</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> filtered_files:</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> loaded_covers:</span></span>
<span class="line"><span style="color:#E1E4E8">            load_cover_async(</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">)</span></span></code></pre>
<hr>
<h2 id="déploiement">Déploiement</h2>
<p><strong>Procédure d’installation</strong> :</p>
<ol>
<li>Cloner le dépôt :</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">git</span><span style="color:#9ECBFF"> clone</span><span style="color:#9ECBFF"> https://github.com/WiWi955/Lecteur-Audio-Style-Spotify.git</span></span></code></pre>
<ol start="2">
<li>Installer les dépendances :</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">pip</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> pygame</span><span style="color:#9ECBFF"> yt-dlp</span><span style="color:#9ECBFF"> requests</span><span style="color:#9ECBFF"> Pillow</span><span style="color:#9ECBFF"> customtkinter</span><span style="color:#9ECBFF"> mutagen</span></span>
<span class="line"></span></code></pre>
<ol start="3">
<li>Lancer avec configuration :</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">python</span><span style="color:#9ECBFF"> Downloader.py</span><span style="color:#79B8FF"> --theme</span><span style="color:#9ECBFF"> dark</span><span style="color:#79B8FF"> --volume</span><span style="color:#79B8FF"> 75</span></span></code></pre>
<hr>
<h2 id="perspectives">Perspectives</h2>
<p><strong>Améliorations prévues</strong> :</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Synchronisation cloud</li>
<li class="task-list-item"><input type="checkbox" disabled> Support des podcasts</li>
<li class="task-list-item"><input type="checkbox" disabled> Égaliseur 10 bandes</li>
<li class="task-list-item"><input type="checkbox" disabled> Lyrics synchronisées</li>
</ul>
<hr>
<h2 id="description-des-onglets">Description des onglets</h2>
<h3 id="-onglet-téléchargement">📥 Onglet Téléchargement</h3>
<p>Cet onglet vous permet de <strong>télécharger de l’audio depuis YouTube</strong>.</p>
<ul>
<li>Saisissez ou collez l’URL d’une vidéo.</li>
<li>Lancez le téléchargement.</li>
<li>Une barre de progression et un statut indiquent l’avancement (<strong>en cours, terminé, erreur</strong>).</li>
</ul>
<h3 id="-onglet-bibliothèque">📂 Onglet Bibliothèque</h3>
<p>Regroupe tous les <strong>fichiers audio téléchargés</strong>.</p>
<ul>
<li>Affichage des morceaux avec <strong>miniature, nom et bouton Favoris</strong>.</li>
<li>Fonction de <strong>recherche</strong> par nom ou tags.</li>
<li>Navigation simplifiée pour <strong>accéder rapidement aux morceaux</strong>.</li>
</ul>
<h3 id="-onglet-playlists">🎵 Onglet Playlists</h3>
<p>Permet de <strong>créer et gérer des playlists</strong>.</p>
<ul>
<li><strong>À gauche</strong> : liste des playlists existantes + bouton de création.</li>
<li><strong>À droite</strong> : contenu de la playlist sélectionnée, possibilité de :
<ul>
<li><strong>Lire toute la playlist</strong>.</li>
<li><strong>Retirer des morceaux individuellement</strong>.</li>
<li><strong>Ajouter le morceau en cours de lecture</strong>.</li>
</ul>
</li>
</ul>
<h3 id="-onglet-historique">⏳ Onglet Historique</h3>
<p>Affiche un <strong>historique des lectures récentes</strong>.</p>
<ul>
<li>Chaque entrée indique <strong>le nom du fichier et l’heure de lecture</strong>.</li>
<li>Un simple clic permet <strong>de relancer la lecture</strong>.</li>
<li>Historique <strong>limité aux 50 dernières lectures</strong> pour plus de clarté.</li>
</ul>
<h3 id="-onglet-favoris">⭐ Onglet Favoris</h3>
<p>Accès rapide aux <strong>morceaux favoris</strong>.</p>
<ul>
<li>Présentation identique à la bibliothèque (<strong>miniature, nom, bouton retirer</strong>).</li>
<li><strong>Le titre en cours de lecture est affiché en vert</strong>.</li>
<li>Gestion facile pour <strong>écouter rapidement ses morceaux préférés</strong>.</li>
</ul>
<h3 id="️-onglet-paramètres">⚙️ Onglet Paramètres</h3>
<p>Permet de <strong>personnaliser l’application</strong>.</p>
<ul>
<li><strong>Changer l’affichage</strong> (mode clair/sombre).</li>
<li>Modifier d’autres <strong>préférences personnelles</strong> selon vos besoins.</li>
</ul>
<hr>
<h2 id="captures-décran">Captures d’Écran</h2>
<!-- Inclure Swiper.js -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<!-- Carrousel moderne -->
<div class="swiper">
  <div class="swiper-wrapper">
    <div class="swiper-slide"><img src="/assets/screen1.jpg" alt="Capture 1"></div>
    <div class="swiper-slide"><img src="/assets/screen2.jpg" alt="Capture 2"></div>
    <div class="swiper-slide"><img src="/assets/screen3.jpg" alt="Capture 3"></div>
    <div class="swiper-slide"><img src="/assets/screen4.jpg" alt="Capture 4"></div>
    <div class="swiper-slide"><img src="/assets/screen5.jpg" alt="Capture 5"></div>
    <div class="swiper-slide"><img src="/assets/screen6.jpg" alt="Capture 6"></div>
    <div class="swiper-slide"><img src="/assets/screen7.jpg" alt="Capture 7"></div>
    <div class="swiper-slide"><img src="/assets/screen8.jpg" alt="Capture 8"></div>
    <div class="swiper-slide"><img src="/assets/screen9.jpg" alt="Capture 9"></div>
    <div class="swiper-slide"><img src="/assets/screen10.jpg" alt="Capture 10"></div>
    <div class="swiper-slide"><img src="/assets/screen11.jpg" alt="Capture 11"></div>
    <div class="swiper-slide"><img src="/assets/screen12.jpg" alt="Capture 12"></div>
  </div>
  <!-- Contrôles -->
  <div class="swiper-pagination"></div>
  <div class="swiper-button-next"></div>
  <div class="swiper-button-prev"></div>
</div>
<!-- Lightbox -->
<div id="lightbox" class="lightbox">
  <span class="close">×</span>
  <img class="lightbox-content" id="lightbox-img" alt="Image en grand">
  <div class="lightbox-prev">❮</div>
  <div class="lightbox-next">❯</div>
</div>
<!-- Styles -->
<style>
  /* Carrousel Swiper */
  .swiper {
    width: 100%;
    height: 40vh;
    margin: 40px auto;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 25px 50px rgba(0,0,0,0.1);
  }
  
  .swiper-slide img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.4s ease;
  }
  
  .swiper-button-next,
  .swiper-button-prev {
    color: purple !important;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(8px);
    border-radius: 50%;
    padding: 20px;
    transition: all 0.3s ease;
  }
  
  .swiper-button-next:hover,
  .swiper-button-prev:hover {
    background: rgba(255,255,255,0.25);
    transform: scale(1.1);
  }
  
  .swiper-pagination-bullet {
    width: 12px;
    height: 12px;
    background: rgba(255,255,255,0.5);
    transition: all 0.2s ease;
  }
  
  .swiper-pagination-bullet-active {
    background: #fff;
    transform: scale(1.4);
  }
  
  @media (max-width: 768px) {
    .swiper {
      height: 60vh;
      width: 100%;
    }
    .swiper-button-next,
    .swiper-button-prev {
      display: none;
    }
  }
  
  /* Lightbox */
  .lightbox {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    align-items: center;
    justify-content: center;
  }
  
  .lightbox-content {
    max-width: 90%;
    max-height: 90%;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }
  
  .close {
    position: absolute;
    top: 20px;
    right: 30px;
    font-size: 40px;
    color: white;
    cursor: pointer;
  }
  
  .lightbox-prev,
  .lightbox-next {
    position: absolute;
    top: 50%;
    font-size: 60px;
    color: white;
    padding: 20px;
    cursor: pointer;
    user-select: none;
    transform: translateY(-50%);
  }
  
  .lightbox-prev {
    left: 20px;
  }
  
  .lightbox-next {
    right: 20px;
  }
</style>
<!-- Configuration Swiper -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    new Swiper('.swiper', {
      effect: 'coverflow',
      grabCursor: true,
      centeredSlides: true,
      slidesPerView: 'auto',
      loop: true,
      keyboard: true,
      coverflowEffect: {
        rotate: 0,
        stretch: 0,
        depth: 100,
        modifier: 2.5,
        slideShadows: false
      },
      autoplay: {
        delay: 5000,
        pauseOnMouseEnter: true
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev'
      }
    });
  });
</script>
<!-- Script Lightbox -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const images = Array.from(document.querySelectorAll(".swiper-slide img"));
    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.getElementById("lightbox-img");
    const closeBtn = document.querySelector(".close");
    const nextBtn = document.querySelector(".lightbox-next");
    const prevBtn = document.querySelector(".lightbox-prev");
    let currentIndex = 0;

    images.forEach((img, index) => {
      img.addEventListener("click", function () {
        lightbox.style.display = "flex";
        lightboxImg.src = this.src;
        currentIndex = index;
      });
    });

    function showImage(index) {
      lightboxImg.src = images[index].src;
    }

    nextBtn.addEventListener("click", function(e) {
      e.stopPropagation();
      currentIndex = (currentIndex + 1) % images.length;
      showImage(currentIndex);
    });

    prevBtn.addEventListener("click", function(e) {
      e.stopPropagation();
      currentIndex = (currentIndex - 1 + images.length) % images.length;
      showImage(currentIndex);
    });

    closeBtn.addEventListener("click", function (e) {
      e.stopPropagation();
      lightbox.style.display = "none";
    });

    lightbox.addEventListener("click", function (e) {
      if (e.target === lightbox) {
        lightbox.style.display = "none";
      }
    });
  });
</script>
<hr>
<h2 id="code-source-complet">Code Source Complet</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="python"><code><span class="line"><span style="color:#6A737D"># ----------- IMPORTATIONS -----------</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> os</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> re</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> threading</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> random</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> time</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> json</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> datetime </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> datetime</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> pygame</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> yt_dlp</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> requests</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#79B8FF"> PIL</span><span style="color:#F97583"> import</span><span style="color:#E1E4E8"> Image, ImageTk, ImageFilter, ImageDraw, ImageFont, ImageOps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> customtkinter </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> ctk</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> tkinter </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> tk</span></span>
<span class="line"><span style="color:#F97583">from</span><span style="color:#E1E4E8"> tkinter </span><span style="color:#F97583">import</span><span style="color:#E1E4E8"> messagebox, simpledialog</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Importation de mutagen pour récupérer la durée d'un MP3 et les tags</span></span>
<span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">    from</span><span style="color:#E1E4E8"> mutagen.mp3 </span><span style="color:#F97583">import</span><span style="color:#79B8FF"> MP3</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#79B8FF"> ImportError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#79B8FF">    MP3</span><span style="color:#F97583"> =</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Gestion des données de l'application ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF">APP_DATA_FILE</span><span style="color:#F97583"> =</span><span style="color:#9ECBFF"> "app_data.json"</span></span>
<span class="line"><span style="color:#79B8FF">DEFAULT_DATA</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">    "playlists"</span><span style="color:#E1E4E8">: {</span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">: []},</span></span>
<span class="line"><span style="color:#9ECBFF">    "history"</span><span style="color:#E1E4E8">: [],</span></span>
<span class="line"><span style="color:#9ECBFF">    "settings"</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#9ECBFF">        "theme"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"Dark"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        "window_size"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"950x900"</span><span style="color:#E1E4E8">,   </span><span style="color:#6A737D"># Taille par défaut de la fenêtre</span></span>
<span class="line"><span style="color:#9ECBFF">        "window_state"</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"zoomed"</span><span style="color:#6A737D">     # État par défaut de la fenêtre</span></span>
<span class="line"><span style="color:#E1E4E8">    },</span></span>
<span class="line"><span style="color:#9ECBFF">    "tags"</span><span style="color:#E1E4E8">: {}  </span><span style="color:#6A737D"># Stockage des tags par fichier</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> load_app_data</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Charge les données de l'application depuis un fichier JSON."""</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">APP_DATA_FILE</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"r"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> f:</span></span>
<span class="line"><span style="color:#F97583">            return</span><span style="color:#E1E4E8"> json.load(f)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> DEFAULT_DATA</span><span style="color:#E1E4E8">.copy()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> save_app_data</span><span style="color:#E1E4E8">(data):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Enregistre les données de l'application dans un fichier JSON."""</span></span>
<span class="line"><span style="color:#F97583">    with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">APP_DATA_FILE</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"w"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> f:</span></span>
<span class="line"><span style="color:#E1E4E8">        json.dump(data, f, </span><span style="color:#FFAB70">indent</span><span style="color:#F97583">=</span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">app_data </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> load_app_data()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Initialisation de pygame ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">os.environ[</span><span style="color:#9ECBFF">"SDL_VIDEODRIVER"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "dummy"</span></span>
<span class="line"><span style="color:#E1E4E8">pygame.mixer.init()</span></span>
<span class="line"><span style="color:#E1E4E8">pygame.display.init()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Configuration de CustomTkinter ---</span></span>
<span class="line"><span style="color:#E1E4E8">ctk.set_appearance_mode(app_data[</span><span style="color:#9ECBFF">"settings"</span><span style="color:#E1E4E8">].get(</span><span style="color:#9ECBFF">"theme"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Dark"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">ctk.set_default_color_theme(</span><span style="color:#9ECBFF">"green"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Variables Globales ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">audio_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">  </span></span>
<span class="line"><span style="color:#E1E4E8">playback_start_time </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">total_paused_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">last_pause_time </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">is_paused </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#E1E4E8">cover_img_global </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">loop_enabled </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Gestion de la playlist active</span></span>
<span class="line"><span style="color:#E1E4E8">current_playlist </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span><span style="color:#6A737D">            # Nom de la playlist en cours</span></span>
<span class="line"><span style="color:#E1E4E8">current_playlist_index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#6A737D">         # Index du morceau actuellement joué</span></span>
<span class="line"><span style="color:#E1E4E8">current_playlist_selected </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span><span style="color:#6A737D">   # Playlist affichée dans l'onglet Playlists</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Dictionnaires et listes de gestion</span></span>
<span class="line"><span style="color:#E1E4E8">playlists </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}                   </span><span style="color:#6A737D"># Autres playlists que "Favoris"</span></span>
<span class="line"><span style="color:#E1E4E8">library_items </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}               </span><span style="color:#6A737D"># {filename: frame_widget}</span></span>
<span class="line"><span style="color:#E1E4E8">library_title_widgets </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {}       </span><span style="color:#6A737D"># Pour la mise en évidence dans la bibliothèque</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Fonctions utilitaires ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> round_rectangle</span><span style="color:#E1E4E8">(canvas, x1, y1, x2, y2, radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">6</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">**</span><span style="color:#E1E4E8">kwargs):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Dessine un rectangle aux coins arrondis sur le canvas."""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> x2 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> x1 </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> radius:</span></span>
<span class="line"><span style="color:#E1E4E8">        radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (x2 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> x1) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> y2 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> y1 </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> *</span><span style="color:#E1E4E8"> radius:</span></span>
<span class="line"><span style="color:#E1E4E8">        radius </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (y2 </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> y1) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#E1E4E8">    points </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> [</span></span>
<span class="line"><span style="color:#E1E4E8">        x1</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">radius, y1,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">radius, y1,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2, y1,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2, y1</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">radius,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2, y2</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">radius,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2, y2,</span></span>
<span class="line"><span style="color:#E1E4E8">        x2</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">radius, y2,</span></span>
<span class="line"><span style="color:#E1E4E8">        x1</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">radius, y2,</span></span>
<span class="line"><span style="color:#E1E4E8">        x1, y2,</span></span>
<span class="line"><span style="color:#E1E4E8">        x1, y2</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">radius,</span></span>
<span class="line"><span style="color:#E1E4E8">        x1, y1</span><span style="color:#F97583">+</span><span style="color:#E1E4E8">radius,</span></span>
<span class="line"><span style="color:#E1E4E8">        x1, y1</span></span>
<span class="line"><span style="color:#E1E4E8">    ]</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> canvas.create_polygon(points, </span><span style="color:#FFAB70">smooth</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">**</span><span style="color:#E1E4E8">kwargs)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> add_rounded_corners</span><span style="color:#E1E4E8">(im, radius):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Ajoute des coins arrondis à une image.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param im: Image PIL</span></span>
<span class="line"><span style="color:#9ECBFF">    :param radius: Rayon des coins</span></span>
<span class="line"><span style="color:#9ECBFF">    :return: Image modifiée avec transparence aux coins</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#E1E4E8">    im </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> im.convert(</span><span style="color:#9ECBFF">"RGBA"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    circle </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.new(</span><span style="color:#9ECBFF">'L'</span><span style="color:#E1E4E8">, (radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">), </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    draw </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageDraw.Draw(circle)</span></span>
<span class="line"><span style="color:#E1E4E8">    draw.ellipse((</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    alpha </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.new(</span><span style="color:#9ECBFF">'L'</span><span style="color:#E1E4E8">, im.size, </span><span style="color:#79B8FF">255</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    w, h </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> im.size</span></span>
<span class="line"><span style="color:#E1E4E8">    alpha.paste(circle.crop((</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, radius, radius)), (</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    alpha.paste(circle.crop((radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, radius)), (w </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> radius, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    alpha.paste(circle.crop((</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, radius, radius, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">)), (</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, h </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> radius))</span></span>
<span class="line"><span style="color:#E1E4E8">    alpha.paste(circle.crop((radius, radius, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, radius </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">)), (w </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> radius, h </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> radius))</span></span>
<span class="line"><span style="color:#E1E4E8">    im.putalpha(alpha)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> im</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_default_cover</span><span style="color:#E1E4E8">(size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">)):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Crée une pochette par défaut en cas d'absence d'image.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param size: Taille de l'image</span></span>
<span class="line"><span style="color:#9ECBFF">    :return: Image PIL générée</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#E1E4E8">    img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.new(</span><span style="color:#9ECBFF">"RGB"</span><span style="color:#E1E4E8">, size, </span><span style="color:#FFAB70">color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#333333"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    draw </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageDraw.Draw(img)</span></span>
<span class="line"><span style="color:#E1E4E8">    font_size </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(size[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">//</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        font </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageFont.truetype(</span><span style="color:#9ECBFF">"arial.ttf"</span><span style="color:#E1E4E8">, font_size)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        font </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageFont.load_default()</span></span>
<span class="line"><span style="color:#E1E4E8">    text </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "No Cover"</span></span>
<span class="line"><span style="color:#E1E4E8">    text_width, text_height </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> draw.textsize(text, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">font)</span></span>
<span class="line"><span style="color:#E1E4E8">    pos </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ((size[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> text_width) </span><span style="color:#F97583">//</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">, (size[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> text_height) </span><span style="color:#F97583">//</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    draw.text(pos, text, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#FFFFFF"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">font)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#E1E4E8"> img</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> notify</span><span style="color:#E1E4E8">(message):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Affiche une notification discrète en haut à gauche."""</span></span>
<span class="line"><span style="color:#E1E4E8">    notif </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(root, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">message, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#444444"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    notif.place(</span><span style="color:#FFAB70">relx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0.01</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">rely</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0.01</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">anchor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"nw"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    root.after(</span><span style="color:#79B8FF">3000</span><span style="color:#E1E4E8">, notif.destroy)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Fonctions de téléchargement et lecture ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> paste_url</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Colle l'URL du presse-papiers dans le champ dédié."""</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        clipboard </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> root.clipboard_get()</span></span>
<span class="line"><span style="color:#E1E4E8">        youtube_url_entry.delete(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, tk.</span><span style="color:#79B8FF">END</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        youtube_url_entry.insert(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, clipboard)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Impossible de récupérer le presse-papiers."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> download_youtube</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Télécharge l'audio depuis une URL YouTube."""</span></span>
<span class="line"><span style="color:#E1E4E8">    url </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> youtube_url_entry.get()</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> url:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Veuillez entrer une URL YouTube valide."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"><span style="color:#E1E4E8">    youtube_url_entry.delete(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, tk.</span><span style="color:#79B8FF">END</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    download_youtube_button.configure(</span><span style="color:#FFAB70">state</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">DISABLED</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    status_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Téléchargement en cours..."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    progress_bar.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    download_percentage_label.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    progress_bar.set(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    download_percentage_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0%"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> download_thread</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            os.makedirs(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">exist_ok</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            ffmpeg_path </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> find_ffmpeg()</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> ffmpeg_path:</span></span>
<span class="line"><span style="color:#E1E4E8">                messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"FFmpeg introuvable."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                return</span></span>
<span class="line"><span style="color:#E1E4E8">            ydl_opts </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#9ECBFF">                'format'</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">'bestaudio/best'</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                'outtmpl'</span><span style="color:#E1E4E8">: os.path.join(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">%(title)s</span><span style="color:#9ECBFF">.</span><span style="color:#79B8FF">%(ext)s</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#9ECBFF">                'noplaylist'</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">                'ffmpeg_location'</span><span style="color:#E1E4E8">: ffmpeg_path,</span></span>
<span class="line"><span style="color:#9ECBFF">                'progress_hooks'</span><span style="color:#E1E4E8">: [update_progress],</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#F97583">            with</span><span style="color:#E1E4E8"> yt_dlp.YoutubeDL(ydl_opts) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> ydl:</span></span>
<span class="line"><span style="color:#E1E4E8">                info_dict </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ydl.extract_info(url, </span><span style="color:#FFAB70">download</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                downloaded_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ydl.prepare_filename(info_dict)</span></span>
<span class="line"><span style="color:#E1E4E8">            cleaned_title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.sub(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">[&#x3C;>:"/</span><span style="color:#85E89D;font-weight:bold">\\</span><span style="color:#79B8FF">|?*]</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">''</span><span style="color:#E1E4E8">, info_dict.get(</span><span style="color:#9ECBFF">'title'</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'audio'</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">            output_filename </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.join(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">cleaned_title</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.mp3"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            os.system(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">ffmpeg_path</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> -i "</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">downloaded_file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">" -vn -ar 44100 -ac 2 -b:a 192k "</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">output_filename</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"'</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> os.path.exists(downloaded_file):</span></span>
<span class="line"><span style="color:#E1E4E8">                os.remove(downloaded_file)</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#9ECBFF"> 'thumbnail'</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> info_dict </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> info_dict[</span><span style="color:#9ECBFF">'thumbnail'</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#E1E4E8">                thumbnail_url </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> info_dict[</span><span style="color:#9ECBFF">'thumbnail'</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#F97583">                try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                    response </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> requests.get(thumbnail_url)</span></span>
<span class="line"><span style="color:#F97583">                    if</span><span style="color:#E1E4E8"> response.status_code </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 200</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                        os.makedirs(</span><span style="color:#9ECBFF">"Pochette_album"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">exist_ok</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">                        thumbnail_path </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.join(</span><span style="color:#9ECBFF">"Pochette_album"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">cleaned_title</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.jpg"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">                        with</span><span style="color:#79B8FF"> open</span><span style="color:#E1E4E8">(thumbnail_path, </span><span style="color:#9ECBFF">"wb"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">as</span><span style="color:#E1E4E8"> f:</span></span>
<span class="line"><span style="color:#E1E4E8">                            f.write(response.content)</span></span>
<span class="line"><span style="color:#F97583">                except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">                    print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Erreur téléchargement miniature : </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">e</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            messagebox.showinfo(</span><span style="color:#9ECBFF">"Succès"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Téléchargement terminé:</span><span style="color:#79B8FF">\n{</span><span style="color:#E1E4E8">output_filename</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            status_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Prêt"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            update_library_view()</span></span>
<span class="line"><span style="color:#E1E4E8">            update_playlists_view()</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#E1E4E8">            messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Une erreur est survenue: </span><span style="color:#79B8FF">{str</span><span style="color:#E1E4E8">(e)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            status_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        finally</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            download_youtube_button.configure(</span><span style="color:#FFAB70">state</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">NORMAL</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            progress_bar.pack_forget()</span></span>
<span class="line"><span style="color:#E1E4E8">            download_percentage_label.pack_forget()</span></span>
<span class="line"><span style="color:#E1E4E8">            progress_bar.set(</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    threading.Thread(</span><span style="color:#FFAB70">target</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">download_thread).start()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_progress</span><span style="color:#E1E4E8">(d):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Met à jour la barre de progression durant le téléchargement."""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> d[</span><span style="color:#9ECBFF">'status'</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> 'downloading'</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        percent_str </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> re.search(</span><span style="color:#F97583">r</span><span style="color:#9ECBFF">'</span><span style="color:#79B8FF">(\d</span><span style="color:#F97583">+</span><span style="color:#85E89D;font-weight:bold">\.</span><span style="color:#79B8FF">\d</span><span style="color:#F97583">+</span><span style="color:#79B8FF">)</span><span style="color:#DBEDFF">%</span><span style="color:#9ECBFF">'</span><span style="color:#E1E4E8">, d[</span><span style="color:#9ECBFF">'_percent_str'</span><span style="color:#E1E4E8">])</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> percent_str:</span></span>
<span class="line"><span style="color:#E1E4E8">            percent </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(percent_str.group(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">            progress_bar.set(percent </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 100</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            download_percentage_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{int</span><span style="color:#E1E4E8">(percent)</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">%"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            root.update_idletasks()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> find_ffmpeg</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Retourne le chemin vers FFmpeg s'il est disponible."""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> os.system(</span><span style="color:#9ECBFF">"ffmpeg -version"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#9ECBFF"> "ffmpeg"</span></span>
<span class="line"><span style="color:#E1E4E8">    common_path </span><span style="color:#F97583">=</span><span style="color:#F97583"> r</span><span style="color:#9ECBFF">"</span><span style="color:#DBEDFF">C:</span><span style="color:#85E89D;font-weight:bold">\f</span><span style="color:#DBEDFF">fmpeg</span><span style="color:#79B8FF">\b</span><span style="color:#DBEDFF">in</span><span style="color:#85E89D;font-weight:bold">\f</span><span style="color:#DBEDFF">fmpeg</span><span style="color:#79B8FF">.</span><span style="color:#DBEDFF">exe</span><span style="color:#9ECBFF">"</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> os.path.exists(common_path):</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> common_path</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> play_audio_by_filename</span><span style="color:#E1E4E8">(filename, playlist_name</span><span style="color:#F97583">=</span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Joue un fichier audio et gère l'affichage de la pochette, la lecture et la mise à jour de la playlist.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param filename: Nom du fichier audio</span></span>
<span class="line"><span style="color:#9ECBFF">    :param playlist_name: Nom de la playlist si applicable</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> audio_duration, playback_start_time, total_paused_duration, is_paused, cover_img_global, current_playlist, current_playlist_index</span></span>
<span class="line"><span style="color:#E1E4E8">    selected_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.join(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">, filename)</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        pygame.mixer.music.load(selected_file)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Impossible de lire le fichier : </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">e</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"><span style="color:#E1E4E8">    pygame.mixer.music.play()</span></span>
<span class="line"><span style="color:#E1E4E8">    pygame.mixer.music.set_endevent(pygame.</span><span style="color:#79B8FF">USEREVENT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    update_now_playing(filename)</span></span>
<span class="line"><span style="color:#E1E4E8">    playback_start_time </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> time.time()</span></span>
<span class="line"><span style="color:#E1E4E8">    total_paused_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">    last_pause_time </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">    is_paused </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#E1E4E8">    current_time_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0:00"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # Récupération de la durée audio</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> MP3</span><span style="color:#F97583"> is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            audio </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> MP3(selected_file)</span></span>
<span class="line"><span style="color:#E1E4E8">            audio_duration </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> audio.info.length</span></span>
<span class="line"><span style="color:#E1E4E8">            total_time_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">format_time(audio_duration))</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            audio_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">            total_time_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0:00"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        audio_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">        total_time_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0:00"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#6A737D">    # Affichage de la pochette</span></span>
<span class="line"><span style="color:#E1E4E8">    base_name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.splitext(filename)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">    cover_path </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.join(</span><span style="color:#9ECBFF">"Pochette_album"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">base_name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.jpg"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> os.path.exists(cover_path):</span></span>
<span class="line"><span style="color:#E1E4E8">        img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> create_default_cover(</span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.open(cover_path)</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        cover_clear </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageOps.fit(img, (</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">method</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">Image.</span><span style="color:#79B8FF">LANCZOS</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">centering</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">        bg_size </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        blurred </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> cover_clear.resize(bg_size).filter(ImageFilter.GaussianBlur(</span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">        composite </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> blurred.copy()</span></span>
<span class="line"><span style="color:#E1E4E8">        offset </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ((bg_size[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">cover_clear.width)</span><span style="color:#F97583">//</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, (bg_size[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">cover_clear.height)</span><span style="color:#F97583">//</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        composite.paste(cover_clear, offset)</span></span>
<span class="line"><span style="color:#E1E4E8">        final_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> add_rounded_corners(composite, </span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">30</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        cover_img_global </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(</span><span style="color:#FFAB70">light_image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">final_img, </span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">        cover_label.configure(</span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">cover_img_global)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">        print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Erreur chargement cover : </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">e</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    update_library_highlight()</span></span>
<span class="line"><span style="color:#E1E4E8">    add_to_history(filename)</span></span>
<span class="line"><span style="color:#E1E4E8">    update_favorites_view()</span></span>
<span class="line"><span style="color:#E1E4E8">    update_playlists_view()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">    # Mise à jour de la playlist active si applicable</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> playlist_name </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        current_playlist </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> playlist_name</span></span>
<span class="line"><span style="color:#E1E4E8">        playlist_tracks </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(playlist_name, [])</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_playlist_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> playlist_tracks.index(filename)</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_playlist_index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        current_playlist </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_now_playing</span><span style="color:#E1E4E8">(file):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Met à jour l'affichage du morceau en cours et affiche une notification."""</span></span>
<span class="line"><span style="color:#E1E4E8">    now_playing_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"En cours de lecture : </span><span style="color:#79B8FF">{</span><span style="color:#FFAB70">file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Lancement de </span><span style="color:#79B8FF">{</span><span style="color:#FFAB70">file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_library_highlight</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Met en évidence le fichier audio actuellement lu dans la bibliothèque."""</span></span>
<span class="line"><span style="color:#E1E4E8">    current_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> now_playing_label.cget(</span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"En cours de lecture : "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#FFAB70"> file</span><span style="color:#E1E4E8">, widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> library_title_widgets.items():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.configure(</span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#F97583"> if</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> ==</span><span style="color:#E1E4E8"> current_file </span><span style="color:#F97583">else</span><span style="color:#9ECBFF"> "white"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> pause_audio</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Permet de mettre en pause ou reprendre la lecture."""</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> is_paused, last_pause_time, total_paused_duration</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> pygame.mixer.music.get_busy() </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> is_paused:</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> is_paused:</span></span>
<span class="line"><span style="color:#E1E4E8">            pygame.mixer.music.pause()</span></span>
<span class="line"><span style="color:#E1E4E8">            is_paused </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> True</span></span>
<span class="line"><span style="color:#E1E4E8">            last_pause_time </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> time.time()</span></span>
<span class="line"><span style="color:#E1E4E8">            pause_btn.configure(</span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">play_img)</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            pygame.mixer.music.unpause()</span></span>
<span class="line"><span style="color:#E1E4E8">            is_paused </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> last_pause_time </span><span style="color:#F97583">is</span><span style="color:#F97583"> not</span><span style="color:#79B8FF"> None</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                total_paused_duration </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> time.time() </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> last_pause_time</span></span>
<span class="line"><span style="color:#E1E4E8">            last_pause_time </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> None</span></span>
<span class="line"><span style="color:#E1E4E8">            pause_btn.configure(</span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">pause_img)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showwarning(</span><span style="color:#9ECBFF">"Aucune lecture"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Aucun fichier audio en lecture."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> next_track</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Passe au morceau suivant dans la playlist ou dans la bibliothèque."""</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> current_playlist, current_playlist_index</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> current_playlist:</span></span>
<span class="line"><span style="color:#E1E4E8">        playlist_tracks </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(current_playlist, [])</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> playlist_tracks:</span></span>
<span class="line"><span style="color:#F97583">            return</span></span>
<span class="line"><span style="color:#E1E4E8">        current_playlist_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (current_playlist_index </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(playlist_tracks)</span></span>
<span class="line"><span style="color:#E1E4E8">        next_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> playlist_tracks[current_playlist_index]</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(next_file, current_playlist)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        audio_files </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">([f </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> f </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> os.listdir(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> f.endswith(</span><span style="color:#9ECBFF">".mp3"</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#E1E4E8">        current_title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> now_playing_label.cget(</span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"En cours de lecture : "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> audio_files.index(current_title)</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_index </span><span style="color:#F97583">=</span><span style="color:#F97583"> -</span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#E1E4E8">        next_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (current_index </span><span style="color:#F97583">+</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(audio_files)</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(audio_files[next_index])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> previous_track</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Reprend le morceau précédent dans la playlist ou la bibliothèque."""</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> current_playlist, current_playlist_index</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> current_playlist:</span></span>
<span class="line"><span style="color:#E1E4E8">        playlist_tracks </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(current_playlist, [])</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> playlist_tracks:</span></span>
<span class="line"><span style="color:#F97583">            return</span></span>
<span class="line"><span style="color:#E1E4E8">        current_playlist_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (current_playlist_index </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(playlist_tracks)</span></span>
<span class="line"><span style="color:#E1E4E8">        prev_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> playlist_tracks[current_playlist_index]</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(prev_file, current_playlist)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        audio_files </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">([f </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> f </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> os.listdir(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> f.endswith(</span><span style="color:#9ECBFF">".mp3"</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#E1E4E8">        current_title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> now_playing_label.cget(</span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"En cours de lecture : "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> audio_files.index(current_title)</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> ValueError</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            current_index </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">        previous_index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (current_index </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(audio_files)</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(audio_files[previous_index])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> toggle_loop</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Active ou désactive la boucle de lecture."""</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> loop_enabled</span></span>
<span class="line"><span style="color:#E1E4E8">    loop_enabled </span><span style="color:#F97583">=</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> loop_enabled</span></span>
<span class="line"><span style="color:#E1E4E8">    loop_btn.configure(</span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">loop_img </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> loop_enabled </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> no_loop_img)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> shuffle_playlist</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Lit un fichier audio aléatoire parmi ceux disponibles."""</span></span>
<span class="line"><span style="color:#E1E4E8">    audio_files </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">([f </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> f </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> os.listdir(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> f.endswith(</span><span style="color:#9ECBFF">".mp3"</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#E1E4E8">    random.shuffle(audio_files)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> audio_files:</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(audio_files[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> set_volume</span><span style="color:#E1E4E8">(value):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Ajuste le volume de la lecture."""</span></span>
<span class="line"><span style="color:#E1E4E8">    volume </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> float</span><span style="color:#E1E4E8">(value) </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 100</span></span>
<span class="line"><span style="color:#E1E4E8">    pygame.mixer.music.set_volume(volume)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> check_music_end</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Surveille la fin de la lecture pour passer au morceau suivant ou relancer en boucle."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> event </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> pygame.event.get():</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> event.type </span><span style="color:#F97583">==</span><span style="color:#E1E4E8"> pygame.</span><span style="color:#79B8FF">USEREVENT</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> loop_enabled:</span></span>
<span class="line"><span style="color:#E1E4E8">                play_audio_by_filename(now_playing_label.cget(</span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"En cours de lecture : "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">), current_playlist)</span></span>
<span class="line"><span style="color:#F97583">            else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                next_track()</span></span>
<span class="line"><span style="color:#E1E4E8">    root.after(</span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">, check_music_end)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> on_canvas_click</span><span style="color:#E1E4E8">(event):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Permet de chercher dans la piste en cliquant sur la barre de progression."""</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> playback_start_time, total_paused_duration, is_paused</span></span>
<span class="line"><span style="color:#E1E4E8">    canvas_width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> progress_canvas.winfo_width()</span></span>
<span class="line"><span style="color:#E1E4E8">    new_fraction </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> event.x </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> canvas_width</span></span>
<span class="line"><span style="color:#E1E4E8">    new_time </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> new_fraction </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> audio_duration</span></span>
<span class="line"><span style="color:#F97583">    try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        pygame.mixer.music.play(</span><span style="color:#FFAB70">start</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">new_time)</span></span>
<span class="line"><span style="color:#F97583">    except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">        print</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"La recherche n'est peut-être pas supportée :"</span><span style="color:#E1E4E8">, e)</span></span>
<span class="line"><span style="color:#E1E4E8">    playback_start_time </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> time.time() </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> new_time</span></span>
<span class="line"><span style="color:#E1E4E8">    total_paused_duration </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">    is_paused </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> False</span></span>
<span class="line"><span style="color:#E1E4E8">    pause_btn.configure(</span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">pause_img)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_canvas_progress</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Met à jour la barre de progression de la lecture."""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> playback_start_time </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> audio_duration </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        elapsed </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (last_pause_time </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> playback_start_time </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> total_paused_duration) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> (is_paused </span><span style="color:#F97583">and</span><span style="color:#E1E4E8"> last_pause_time) </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> (time.time() </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> playback_start_time </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> total_paused_duration)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> elapsed </span><span style="color:#F97583">&#x3C;</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            elapsed </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">        fraction </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> elapsed </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> audio_duration </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> audio_duration </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 0</span><span style="color:#F97583"> else</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">        fraction </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> min</span><span style="color:#E1E4E8">(fraction, </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        canvas_width </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> progress_canvas.winfo_width()</span></span>
<span class="line"><span style="color:#E1E4E8">        progress_canvas.delete(</span><span style="color:#9ECBFF">"progress"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        round_rectangle(progress_canvas, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, fraction </span><span style="color:#F97583">*</span><span style="color:#E1E4E8"> canvas_width, </span><span style="color:#79B8FF">8</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">6</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">outline</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">tag</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"progress"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        current_time_label.configure(</span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">format_time(elapsed))</span></span>
<span class="line"><span style="color:#E1E4E8">    root.after(</span><span style="color:#79B8FF">1000</span><span style="color:#E1E4E8">, update_canvas_progress)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> format_time</span><span style="color:#E1E4E8">(seconds):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Formate un temps en secondes au format minutes:secondes."""</span></span>
<span class="line"><span style="color:#E1E4E8">    minutes </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(seconds </span><span style="color:#F97583">//</span><span style="color:#79B8FF"> 60</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    sec </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> int</span><span style="color:#E1E4E8">(seconds </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 60</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#F97583"> f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">minutes</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">:</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">sec</span><span style="color:#F97583">:02d</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Gestion de la bibliothèque ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_library_view</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Actualise l'affichage de la bibliothèque audio."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> library_scrollable_frame.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"><span style="color:#E1E4E8">    library_items.clear()</span></span>
<span class="line"><span style="color:#E1E4E8">    library_title_widgets.clear()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> os.path.exists(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"><span style="color:#E1E4E8">    all_files </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> sorted</span><span style="color:#E1E4E8">([f </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> f </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> os.listdir(</span><span style="color:#9ECBFF">"audio"</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">if</span><span style="color:#E1E4E8"> f.endswith(</span><span style="color:#9ECBFF">".mp3"</span><span style="color:#E1E4E8">)])</span></span>
<span class="line"><span style="color:#E1E4E8">    query </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> search_entry.get().lower()</span></span>
<span class="line"><span style="color:#E1E4E8">    filtered_files </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> f </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> all_files:</span></span>
<span class="line"><span style="color:#E1E4E8">        match </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> query </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> f.lower()</span></span>
<span class="line"><span style="color:#E1E4E8">        tags </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"tags"</span><span style="color:#E1E4E8">].get(f, {})</span></span>
<span class="line"><span style="color:#E1E4E8">        tag_match </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">(query </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(v).lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> v </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> tags.values())</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> match </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> tag_match </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> query </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> ""</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            filtered_files.append(f)</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> filtered_files:</span></span>
<span class="line"><span style="color:#E1E4E8">        base_name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.splitext(</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">)[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">        cover_path </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> os.path.join(</span><span style="color:#9ECBFF">"Pochette_album"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">base_name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">.jpg"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> os.path.exists(cover_path):</span></span>
<span class="line"><span style="color:#E1E4E8">            img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> create_default_cover(</span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">            try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.open(cover_path)</span></span>
<span class="line"><span style="color:#F97583">            except</span><span style="color:#79B8FF"> Exception</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">                img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> create_default_cover(</span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#F97583">        try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            cover_clear </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageOps.fit(img, (</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">method</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">Image.</span><span style="color:#79B8FF">LANCZOS</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">centering</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0.5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">            bg_size </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> (</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            blurred </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> cover_clear.resize(bg_size).filter(ImageFilter.GaussianBlur(</span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">            composite </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> blurred.copy()</span></span>
<span class="line"><span style="color:#E1E4E8">            offset </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ((bg_size[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">cover_clear.width)</span><span style="color:#F97583">//</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, (bg_size[</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">]</span><span style="color:#F97583">-</span><span style="color:#E1E4E8">cover_clear.height)</span><span style="color:#F97583">//</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            composite.paste(cover_clear, offset)</span></span>
<span class="line"><span style="color:#E1E4E8">            final_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> add_rounded_corners(composite, </span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            cover_ctk </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(</span><span style="color:#FFAB70">light_image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">final_img, </span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#F97583">        except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">            print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Erreur chargement cover pour </span><span style="color:#79B8FF">{</span><span style="color:#FFAB70">file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> : </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">e</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            cover_ctk </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(</span><span style="color:#FFAB70">light_image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">create_default_cover(</span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">)), </span><span style="color:#FFAB70">size</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">70</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">        </span></span>
<span class="line"><span style="color:#E1E4E8">        item_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(library_scrollable_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        item_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        img_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(item_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">cover_ctk, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        img_label.image </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> cover_ctk</span></span>
<span class="line"><span style="color:#E1E4E8">        img_label.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        title_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(item_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        title_frame.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        title_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(title_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Arial"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"bold"</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        title_label.pack(</span><span style="color:#FFAB70">anchor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"w"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        fav_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(item_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"☆"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">30</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> f</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">: toggle_favorite(f))</span></span>
<span class="line"><span style="color:#E1E4E8">        fav_btn.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">RIGHT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">        # Lancement de la lecture au clic sur l'item</span></span>
<span class="line"><span style="color:#E1E4E8">        item_frame.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, filename</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">: play_audio_by_filename(filename))</span></span>
<span class="line"><span style="color:#E1E4E8">        img_label.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, filename</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">: play_audio_by_filename(filename))</span></span>
<span class="line"><span style="color:#E1E4E8">        title_label.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, filename</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">: play_audio_by_filename(filename))</span></span>
<span class="line"><span style="color:#E1E4E8">        library_items[</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> item_frame</span></span>
<span class="line"><span style="color:#E1E4E8">        library_title_widgets[</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> title_label</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> toggle_favorite</span><span style="color:#E1E4E8">(filename):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Ajoute ou retire un fichier des favoris."""</span></span>
<span class="line"><span style="color:#E1E4E8">    favoris </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].setdefault(</span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">, [])</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> filename </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> favoris:</span></span>
<span class="line"><span style="color:#E1E4E8">        favoris.remove(filename)</span></span>
<span class="line"><span style="color:#E1E4E8">        notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">filename</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> retiré des favoris"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        favoris.append(filename)</span></span>
<span class="line"><span style="color:#E1E4E8">        notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">filename</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> ajouté aux favoris"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    save_app_data(app_data)</span></span>
<span class="line"><span style="color:#E1E4E8">    update_library_view()</span></span>
<span class="line"><span style="color:#E1E4E8">    update_favorites_view()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Gestion de l'historique ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_history_view</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Affiche l'historique des lectures."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> history_scroll.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"><span style="color:#E1E4E8">    </span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> entry </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> reversed</span><span style="color:#E1E4E8">(app_data[</span><span style="color:#9ECBFF">"history"</span><span style="color:#E1E4E8">]):</span></span>
<span class="line"><span style="color:#E1E4E8">        frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(history_scroll)</span></span>
<span class="line"><span style="color:#E1E4E8">        frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        timestamp </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> datetime.fromisoformat(entry[</span><span style="color:#9ECBFF">"timestamp"</span><span style="color:#E1E4E8">]).strftime(</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">%d</span><span style="color:#9ECBFF">/%m %H:%M"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">timestamp</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> - </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">entry[</span><span style="color:#9ECBFF">'file'</span><span style="color:#E1E4E8">]</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        label.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        label.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, f</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">entry[</span><span style="color:#9ECBFF">'file'</span><span style="color:#E1E4E8">]: play_audio_by_filename(f))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> add_to_history</span><span style="color:#E1E4E8">(filename):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Ajoute une lecture à l'historique et limite celui-ci à 50 entrées."""</span></span>
<span class="line"><span style="color:#E1E4E8">    app_data[</span><span style="color:#9ECBFF">"history"</span><span style="color:#E1E4E8">].append({</span></span>
<span class="line"><span style="color:#9ECBFF">        "file"</span><span style="color:#E1E4E8">: filename,</span></span>
<span class="line"><span style="color:#9ECBFF">        "timestamp"</span><span style="color:#E1E4E8">: datetime.now().isoformat()</span></span>
<span class="line"><span style="color:#E1E4E8">    })</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#79B8FF"> len</span><span style="color:#E1E4E8">(app_data[</span><span style="color:#9ECBFF">"history"</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">></span><span style="color:#79B8FF"> 50</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"history"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"history"</span><span style="color:#E1E4E8">][</span><span style="color:#F97583">-</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">:]</span></span>
<span class="line"><span style="color:#E1E4E8">    save_app_data(app_data)</span></span>
<span class="line"><span style="color:#E1E4E8">    update_history_view()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Gestion des favoris ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_favorites_view</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Actualise l'affichage des favoris."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> favorites_scroll.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"><span style="color:#E1E4E8">    fav_files </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(</span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">, [])</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> fav_files:</span></span>
<span class="line"><span style="color:#E1E4E8">        tk.Label(favorites_scroll, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Aucun favori."</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">bg</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">).pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> fav_files:</span></span>
<span class="line"><span style="color:#E1E4E8">        frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(favorites_scroll, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        lbl </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tk.Label(frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">bg</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        lbl.pack(</span><span style="color:#FFAB70">anchor</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"w"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        lbl.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, f</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">: play_audio_by_filename(f, </span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Recherche dans la bibliothèque ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> search_library</span><span style="color:#E1E4E8">(event</span><span style="color:#F97583">=</span><span style="color:#79B8FF">None</span><span style="color:#E1E4E8">):</span></span>
<span class="line"><span style="color:#9ECBFF">    """Filtre la bibliothèque selon la requête saisie."""</span></span>
<span class="line"><span style="color:#E1E4E8">    query </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> search_entry.get().lower()</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#FFAB70"> file</span><span style="color:#E1E4E8">, frame </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> library_items.items():</span></span>
<span class="line"><span style="color:#E1E4E8">        match </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> query </span><span style="color:#F97583">in</span><span style="color:#FFAB70"> file</span><span style="color:#E1E4E8">.lower()</span></span>
<span class="line"><span style="color:#E1E4E8">        tags </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"tags"</span><span style="color:#E1E4E8">].get(</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, {})</span></span>
<span class="line"><span style="color:#E1E4E8">        tag_match </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> any</span><span style="color:#E1E4E8">(query </span><span style="color:#F97583">in</span><span style="color:#79B8FF"> str</span><span style="color:#E1E4E8">(v).lower() </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> v </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> tags.values())</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> match </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> tag_match </span><span style="color:#F97583">or</span><span style="color:#E1E4E8"> query </span><span style="color:#F97583">==</span><span style="color:#9ECBFF"> ""</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">            frame.pack_forget()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Paramètres d'affichage (Mode sombre/clair) ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> toggle_mode</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Change le mode d'affichage et sauvegarde le paramètre."""</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> appearance_switch.get():</span></span>
<span class="line"><span style="color:#E1E4E8">        ctk.set_appearance_mode(</span><span style="color:#9ECBFF">"dark"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"settings"</span><span style="color:#E1E4E8">][</span><span style="color:#9ECBFF">"theme"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "Dark"</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        ctk.set_appearance_mode(</span><span style="color:#9ECBFF">"light"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"settings"</span><span style="color:#E1E4E8">][</span><span style="color:#9ECBFF">"theme"</span><span style="color:#E1E4E8">] </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "Light"</span></span>
<span class="line"><span style="color:#E1E4E8">    save_app_data(app_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Création de playlist ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> create_playlist</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Ouvre une fenêtre modale pour créer une nouvelle playlist."""</span></span>
<span class="line"><span style="color:#E1E4E8">    dialog </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkToplevel(root)</span></span>
<span class="line"><span style="color:#E1E4E8">    dialog.title(</span><span style="color:#9ECBFF">"Créer une Playlist"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    dialog.geometry(</span><span style="color:#9ECBFF">"300x150"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    dialog.resizable(</span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">False</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    dialog.grab_set()  </span><span style="color:#6A737D"># Rend la fenêtre modale</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(dialog, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Nom de la nouvelle playlist :"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Arial"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"bold"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">    label.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    entry </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkEntry(dialog, </span><span style="color:#FFAB70">placeholder_text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Nom de la playlist"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    entry.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> submit</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#E1E4E8">        name </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> entry.get().strip()</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> name:</span></span>
<span class="line"><span style="color:#E1E4E8">            messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Veuillez entrer un nom valide."</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">parent</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">dialog)</span></span>
<span class="line"><span style="color:#F97583">            return</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">]:</span></span>
<span class="line"><span style="color:#E1E4E8">            messagebox.showerror(</span><span style="color:#9ECBFF">"Erreur"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Une playlist avec ce nom existe déjà."</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">parent</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">dialog)</span></span>
<span class="line"><span style="color:#F97583">            return</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">][name] </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> []</span></span>
<span class="line"><span style="color:#E1E4E8">        save_app_data(app_data)</span></span>
<span class="line"><span style="color:#E1E4E8">        refresh_playlist_buttons()</span></span>
<span class="line"><span style="color:#E1E4E8">        notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Playlist '</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">' créée."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        dialog.destroy()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    submit_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(dialog, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Créer"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">submit, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">hover_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#16a34a"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    submit_btn.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    entry.focus()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Interface graphique principale ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">root </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTk()</span></span>
<span class="line"><span style="color:#E1E4E8">root.title(</span><span style="color:#9ECBFF">"Spotify-like Player"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">root.geometry(app_data[</span><span style="color:#9ECBFF">"settings"</span><span style="color:#E1E4E8">].get(</span><span style="color:#9ECBFF">"window_size"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"950x900"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">root.state(app_data[</span><span style="color:#9ECBFF">"settings"</span><span style="color:#E1E4E8">].get(</span><span style="color:#9ECBFF">"window_state"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"zoomed"</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Chargement de l'icône</span></span>
<span class="line"><span style="color:#E1E4E8">icon_path </span><span style="color:#F97583">=</span><span style="color:#9ECBFF"> "img/icon.ico"</span></span>
<span class="line"><span style="color:#F97583">try</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">    icon </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> Image.open(icon_path)</span></span>
<span class="line"><span style="color:#E1E4E8">    photo </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ImageTk.PhotoImage(icon)</span></span>
<span class="line"><span style="color:#E1E4E8">    root.iconphoto(</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, photo)</span></span>
<span class="line"><span style="color:#F97583">except</span><span style="color:#79B8FF"> Exception</span><span style="color:#F97583"> as</span><span style="color:#E1E4E8"> e:</span></span>
<span class="line"><span style="color:#79B8FF">    print</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"Erreur chargement icône : </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">e</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Cadre principal et Tabview</span></span>
<span class="line"><span style="color:#E1E4E8">main_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(root)</span></span>
<span class="line"><span style="color:#E1E4E8">main_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">tabview </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkTabview(main_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Téléchargement"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Bibliothèque"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Playlists"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Historique"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">tabview.add(</span><span style="color:#9ECBFF">"Paramètres"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Téléchargement ---</span></span>
<span class="line"><span style="color:#E1E4E8">download_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Téléchargement"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ctk.CTkLabel(download_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Téléchargement YouTube"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'Arial'</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">12</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">'bold'</span><span style="color:#E1E4E8">)).pack(</span><span style="color:#FFAB70">anchor</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.W, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">url_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(download_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">url_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">youtube_url_entry </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkEntry(url_frame, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">60</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">youtube_url_entry.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">paste_url_button </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(url_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Coller"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">paste_url, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">paste_url_button.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">download_youtube_button </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(download_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Télécharger"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">download_youtube, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">download_youtube_button.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">progress_bar </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkProgressBar(download_frame, </span><span style="color:#FFAB70">orientation</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"horizontal"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">mode</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"determinate"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">download_percentage_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(download_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0%"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Arial"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">status_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(download_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Prêt"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"green"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">status_label.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Bibliothèque ---</span></span>
<span class="line"><span style="color:#E1E4E8">library_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Bibliothèque"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">search_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(library_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">search_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">search_entry </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkEntry(search_frame, </span><span style="color:#FFAB70">placeholder_text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Rechercher..."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">search_entry.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">search_entry.bind(</span><span style="color:#9ECBFF">"&#x3C;KeyRelease>"</span><span style="color:#E1E4E8">, search_library)</span></span>
<span class="line"><span style="color:#E1E4E8">library_scrollable_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkScrollableFrame(library_frame, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">800</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">height</span><span style="color:#F97583">=</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">library_scrollable_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">update_library_view()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Playlists ---</span></span>
<span class="line"><span style="color:#E1E4E8">playlists_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Playlists"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_left_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(playlists_frame, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">250</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_left_frame.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.Y, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_right_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(playlists_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_right_frame.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Bouton de création de playlist</span></span>
<span class="line"><span style="color:#E1E4E8">btn_create_playlist </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(playlist_left_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Créer Playlist"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8">: create_playlist(), </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">btn_create_playlist.pack(</span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Zone de scroll pour les playlists</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_buttons_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkScrollableFrame(playlist_left_frame, </span><span style="color:#FFAB70">height</span><span style="color:#F97583">=</span><span style="color:#79B8FF">300</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_buttons_frame.pack(</span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> refresh_playlist_buttons</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Rafraîchit l'affichage des boutons de playlists."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> playlist_buttons_frame.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Gestion des boutons de playlists ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> refresh_playlist_buttons</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Crée un bouton pour chaque playlist existante."""</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> playlist_buttons_frame.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> name </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].keys():</span></span>
<span class="line"><span style="color:#E1E4E8">        btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(</span></span>
<span class="line"><span style="color:#E1E4E8">            playlist_buttons_frame,</span></span>
<span class="line"><span style="color:#FFAB70">            text</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">name,</span></span>
<span class="line"><span style="color:#FFAB70">            fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#333333"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">            hover_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#444444"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">            text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">            command</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> n</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">name: show_playlist_contents_modern(n)</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"><span style="color:#E1E4E8">        btn.pack(</span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> update_playlists_view</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """Mets à jour l'affichage des playlists (pour compatibilité)."""</span></span>
<span class="line"><span style="color:#E1E4E8">    refresh_playlist_buttons()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Affichage du contenu d'une playlist ---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">playlist_contents_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(playlist_right_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">playlist_contents_frame.pack(</span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> show_playlist_contents_modern</span><span style="color:#E1E4E8">(playlist_name):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Affiche le contenu de la playlist sélectionnée dans le cadre dédié.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param playlist_name: Nom de la playlist à afficher.</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> current_playlist_selected</span></span>
<span class="line"><span style="color:#E1E4E8">    current_playlist_selected </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> playlist_name</span></span>
<span class="line"><span style="color:#6A737D">    # Réinitialisation du cadre de contenu</span></span>
<span class="line"><span style="color:#F97583">    for</span><span style="color:#E1E4E8"> widget </span><span style="color:#F97583">in</span><span style="color:#E1E4E8"> playlist_contents_frame.winfo_children():</span></span>
<span class="line"><span style="color:#E1E4E8">        widget.destroy()</span></span>
<span class="line"><span style="color:#6A737D">    # En-tête avec le titre de la playlist et le bouton pour lancer la lecture</span></span>
<span class="line"><span style="color:#E1E4E8">    header_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(playlist_contents_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    header_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    lbl_title </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(</span></span>
<span class="line"><span style="color:#E1E4E8">        header_frame,</span></span>
<span class="line"><span style="color:#FFAB70">        text</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">playlist_name,</span></span>
<span class="line"><span style="color:#FFAB70">        font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Arial"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">16</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"bold"</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#FFAB70">        text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">        fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">    lbl_title.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">    btn_play </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(</span></span>
<span class="line"><span style="color:#E1E4E8">        header_frame,</span></span>
<span class="line"><span style="color:#FFAB70">        text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Lire la playlist"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">        fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">        command</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8">: play_playlist(playlist_name)</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">    btn_play.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">RIGHT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">    # Affichage des morceaux</span></span>
<span class="line"><span style="color:#E1E4E8">    songs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(playlist_name, [])</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> songs:</span></span>
<span class="line"><span style="color:#E1E4E8">        lbl_info </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(</span></span>
<span class="line"><span style="color:#E1E4E8">            playlist_contents_frame,</span></span>
<span class="line"><span style="color:#FFAB70">            text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Playlist vide."</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">            text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">            fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1a1a1a"</span></span>
<span class="line"><span style="color:#E1E4E8">        )</span></span>
<span class="line"><span style="color:#E1E4E8">        lbl_info.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> songs:</span></span>
<span class="line"><span style="color:#E1E4E8">            frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(playlist_contents_frame, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            lbl </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#2b2b2b"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            lbl.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">            btn_remove </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(</span></span>
<span class="line"><span style="color:#E1E4E8">                frame,</span></span>
<span class="line"><span style="color:#FFAB70">                text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Supprimer"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">                width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">80</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">                fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#cc3333"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">                text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"white"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">                command</span><span style="color:#F97583">=lambda</span><span style="color:#E1E4E8"> f</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, pl</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">playlist_name: remove_from_playlist(pl, f)</span></span>
<span class="line"><span style="color:#E1E4E8">            )</span></span>
<span class="line"><span style="color:#E1E4E8">            btn_remove.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">RIGHT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#6A737D">            # Lancer le morceau en cliquant sur l'item</span></span>
<span class="line"><span style="color:#E1E4E8">            frame.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, f</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, pl</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">playlist_name: play_audio_by_filename(f, pl))</span></span>
<span class="line"><span style="color:#E1E4E8">            lbl.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e, f</span><span style="color:#F97583">=</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">, pl</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">playlist_name: play_audio_by_filename(f, pl))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> remove_from_playlist</span><span style="color:#E1E4E8">(playlist_name, file):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Retire un morceau de la playlist et met à jour l'affichage.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param playlist_name: Nom de la playlist.</span></span>
<span class="line"><span style="color:#9ECBFF">    :param file: Nom du fichier à retirer.</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#FFAB70"> file</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(playlist_name, []):</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">][playlist_name].remove(</span><span style="color:#FFAB70">file</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">        save_app_data(app_data)</span></span>
<span class="line"><span style="color:#E1E4E8">        refresh_playlist_buttons()</span></span>
<span class="line"><span style="color:#E1E4E8">        show_playlist_contents_modern(playlist_name)</span></span>
<span class="line"><span style="color:#E1E4E8">        notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#FFAB70">file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> retiré de </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">playlist_name</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> play_playlist</span><span style="color:#E1E4E8">(playlist_name):</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Lance la lecture de la playlist en jouant le premier morceau.</span></span>
<span class="line"><span style="color:#9ECBFF">    </span></span>
<span class="line"><span style="color:#9ECBFF">    :param playlist_name: Nom de la playlist à jouer.</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#E1E4E8">    songs </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].get(playlist_name, [])</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> songs:</span></span>
<span class="line"><span style="color:#E1E4E8">        play_audio_by_filename(songs[</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">], playlist_name)</span></span>
<span class="line"><span style="color:#F97583">    else</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showwarning(</span><span style="color:#9ECBFF">"Playlist vide"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Cette playlist est vide."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">def</span><span style="color:#B392F0"> add_current_to_playlist_modern</span><span style="color:#E1E4E8">():</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#9ECBFF">    Ajoute le morceau actuellement lu à la playlist sélectionnée.</span></span>
<span class="line"><span style="color:#9ECBFF">    """</span></span>
<span class="line"><span style="color:#F97583">    global</span><span style="color:#E1E4E8"> current_playlist_selected</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#F97583"> not</span><span style="color:#E1E4E8"> current_playlist_selected:</span></span>
<span class="line"><span style="color:#E1E4E8">        messagebox.showwarning(</span><span style="color:#9ECBFF">"Aucune sélection"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"Sélectionnez une playlist."</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">        return</span></span>
<span class="line"><span style="color:#E1E4E8">    current_file </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> now_playing_label.cget(</span><span style="color:#9ECBFF">"text"</span><span style="color:#E1E4E8">).replace(</span><span style="color:#9ECBFF">"En cours de lecture : "</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">    if</span><span style="color:#E1E4E8"> current_file:</span></span>
<span class="line"><span style="color:#E1E4E8">        app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">].setdefault(current_playlist_selected, [])</span></span>
<span class="line"><span style="color:#F97583">        if</span><span style="color:#E1E4E8"> current_file </span><span style="color:#F97583">not</span><span style="color:#F97583"> in</span><span style="color:#E1E4E8"> app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">][current_playlist_selected]:</span></span>
<span class="line"><span style="color:#E1E4E8">            app_data[</span><span style="color:#9ECBFF">"playlists"</span><span style="color:#E1E4E8">][current_playlist_selected].append(current_file)</span></span>
<span class="line"><span style="color:#E1E4E8">            save_app_data(app_data)</span></span>
<span class="line"><span style="color:#E1E4E8">            show_playlist_contents_modern(current_playlist_selected)</span></span>
<span class="line"><span style="color:#E1E4E8">            notify(</span><span style="color:#F97583">f</span><span style="color:#9ECBFF">"</span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">current_file</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF"> ajouté à </span><span style="color:#79B8FF">{</span><span style="color:#E1E4E8">current_playlist_selected</span><span style="color:#79B8FF">}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">btn_add_current_modern </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(</span></span>
<span class="line"><span style="color:#E1E4E8">    playlist_left_frame,</span></span>
<span class="line"><span style="color:#FFAB70">    text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Ajouter morceau en cours"</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#FFAB70">    command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">add_current_to_playlist_modern,</span></span>
<span class="line"><span style="color:#FFAB70">    fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">btn_add_current_modern.pack(</span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">), </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Rafraîchissement initial des boutons de playlists</span></span>
<span class="line"><span style="color:#E1E4E8">refresh_playlist_buttons()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Historique ---</span></span>
<span class="line"><span style="color:#E1E4E8">history_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Historique"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">history_scroll </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkScrollableFrame(history_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">history_scroll.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Favoris ---</span></span>
<span class="line"><span style="color:#E1E4E8">favorites_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Favoris"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">favorites_scroll </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkScrollableFrame(favorites_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">favorites_scroll.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTH</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">update_favorites_view()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Onglet Paramètres ---</span></span>
<span class="line"><span style="color:#E1E4E8">settings_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tabview.tab(</span><span style="color:#9ECBFF">"Paramètres"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">ctk.CTkLabel(settings_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Paramètres"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">font</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"Arial"</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">14</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"bold"</span><span style="color:#E1E4E8">)).pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">appearance_switch </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkSwitch(settings_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Mode Sombre"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">toggle_mode)</span></span>
<span class="line"><span style="color:#E1E4E8">appearance_switch.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Cadre du Player ---</span></span>
<span class="line"><span style="color:#E1E4E8">player_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(root)</span></span>
<span class="line"><span style="color:#E1E4E8">player_frame.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">BOTTOM</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">cover_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(player_frame, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">height</span><span style="color:#F97583">=</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">corner_radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">30</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">cover_frame.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">cover_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(cover_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">height</span><span style="color:#F97583">=</span><span style="color:#79B8FF">340</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">cover_label.pack()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">audio_progress_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(player_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">audio_progress_frame.pack(</span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">current_time_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(audio_progress_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0:00"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">current_time_label.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">progress_canvas </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> tk.Canvas(audio_progress_frame, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">400</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">height</span><span style="color:#F97583">=</span><span style="color:#79B8FF">8</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">bg</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">'#1C1C1C'</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">highlightthickness</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">progress_canvas.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.X, </span><span style="color:#FFAB70">expand</span><span style="color:#F97583">=</span><span style="color:#79B8FF">True</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">round_rectangle(progress_canvas, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">8</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">radius</span><span style="color:#F97583">=</span><span style="color:#79B8FF">6</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">fill</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">outline</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">tag</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"progress"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">progress_canvas.bind(</span><span style="color:#9ECBFF">"&#x3C;Button-1>"</span><span style="color:#E1E4E8">, on_canvas_click)</span></span>
<span class="line"><span style="color:#E1E4E8">total_time_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(audio_progress_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"0:00"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">total_time_label.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">LEFT</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">control_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(player_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">control_frame.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">10</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">icon_size </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 30</span></span>
<span class="line"><span style="color:#E1E4E8">play_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/play.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">pause_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/pause.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">next_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/next.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">prev_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/previous.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">loop_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/loop.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">no_loop_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/no_loop.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"><span style="color:#E1E4E8">shuffle_img </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkImage(Image.open(</span><span style="color:#9ECBFF">"img/shuffle.png"</span><span style="color:#E1E4E8">).resize((icon_size, icon_size)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">prev_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(control_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">prev_img, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">previous_track, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">prev_btn.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">pause_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(control_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">pause_img, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">pause_audio, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">pause_btn.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">next_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(control_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">next_img, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">next_track, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">next_btn.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">2</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">loop_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(control_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">loop_img, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">toggle_loop, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">loop_btn.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">3</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">shuffle_btn </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkButton(control_frame, </span><span style="color:#FFAB70">image</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">shuffle_img, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">""</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">shuffle_playlist, </span><span style="color:#FFAB70">fg_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"#1cd061"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">shuffle_btn.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">volume_frame </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkFrame(control_frame)</span></span>
<span class="line"><span style="color:#E1E4E8">volume_frame.grid(</span><span style="color:#FFAB70">row</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">column</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">padx</span><span style="color:#F97583">=</span><span style="color:#79B8FF">20</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">volume_scale </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkSlider(volume_frame, </span><span style="color:#FFAB70">from_</span><span style="color:#F97583">=</span><span style="color:#79B8FF">0</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">to</span><span style="color:#F97583">=</span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">command</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">set_volume, </span><span style="color:#FFAB70">width</span><span style="color:#F97583">=</span><span style="color:#79B8FF">100</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">volume_scale.set(</span><span style="color:#79B8FF">50</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">volume_scale.pack(</span><span style="color:#FFAB70">side</span><span style="color:#F97583">=</span><span style="color:#E1E4E8">ctk.</span><span style="color:#79B8FF">RIGHT</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">now_playing_label </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> ctk.CTkLabel(player_frame, </span><span style="color:#FFAB70">text</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"Aucune lecture en cours"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">text_color</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"gray"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">now_playing_label.pack(</span><span style="color:#FFAB70">pady</span><span style="color:#F97583">=</span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># --- Raccourcis clavier ---</span></span>
<span class="line"><span style="color:#E1E4E8">root.bind(</span><span style="color:#9ECBFF">"&#x3C;space>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e: pause_audio())</span></span>
<span class="line"><span style="color:#E1E4E8">root.bind(</span><span style="color:#9ECBFF">"&#x3C;Right>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e: next_track())</span></span>
<span class="line"><span style="color:#E1E4E8">root.bind(</span><span style="color:#9ECBFF">"&#x3C;Left>"</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">lambda</span><span style="color:#E1E4E8"> e: previous_track())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D"># Actualisations et boucle principale</span></span>
<span class="line"><span style="color:#E1E4E8">update_library_view()</span></span>
<span class="line"><span style="color:#E1E4E8">update_playlists_view()</span></span>
<span class="line"><span style="color:#E1E4E8">check_music_end()</span></span>
<span class="line"><span style="color:#E1E4E8">update_canvas_progress()</span></span>
<span class="line"><span style="color:#E1E4E8">root.mainloop()</span></span>
<span class="line"></span></code></pre>
<br>
<a href="/public/assets/Lecteur-Audio-Style-Spotify-main.zip" download>
  <button style="background-color: #7611a6; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 5px;">
    📦 Télécharger le Projet Complet
  </button>
</a>
</div> </div> </div> </main> </div> <aside data-astro-cid-rcdzuq3a> <h2 data-astro-cid-rcdzuq3a>Intéressé par mon profil ?</h2> <a href="mailto:w.nguyen@lprs.fr" data-astro-cid-balv45lp>
Envoie-moi un message.
<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" style="--size:1.2em" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M210.3 35.9 23.9 88.4a8 8 0 0 0-1.2 15l85.6 40.5a7.8 7.8 0 0 1 3.8 3.8l40.5 85.6a8 8 0 0 0 15-1.2l52.5-186.4a7.9 7.9 0 0 0-9.8-9.8Zm-99.4 109.2 45.2-45.2"/></g>  </svg>  </a>  </aside>  </div>  <footer data-astro-cid-sz7xmlte> <div class="group" data-astro-cid-sz7xmlte> <p data-astro-cid-sz7xmlte>
Tous droits réservés
<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 256 256" aria-hidden="true" stroke="currentcolor" fill="currentcolor" style="--size:1.2em" class="astro-patnjmll" data-astro-cid-patnjmll> <g data-astro-cid-patnjmll><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M94.1 184.6c-11.4 33.9-56.6 33.9-56.6 33.9s0-45.2 33.9-56.6m124.5-56.5L128 173.3 82.7 128l67.9-67.9C176.3 34.4 202 34.7 213 36.3a7.8 7.8 0 0 1 6.7 6.7c1.6 11 1.9 36.7-23.8 62.4Z"/><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="16" d="M184.6 116.7v64.6a8 8 0 0 1-2.4 5.6l-32.3 32.4a8 8 0 0 1-13.5-4.1l-8.4-41.9m11.3-101.9H74.7a8 8 0 0 0-5.6 2.4l-32.4 32.3a8 8 0 0 0 4.1 13.5l41.9 8.4"/></g>  </svg>  </p> <p data-astro-cid-sz7xmlte>&copy; 2025 William NGUYEN</p> </div> <p class="socials" data-astro-cid-sz7xmlte> <a href="https://twitter.com/me" data-astro-cid-sz7xmlte> Twitter</a> <a href="https://github.com/me" data-astro-cid-sz7xmlte> GitHub</a> </p> </footer>  </div> <script type="module">addEventListener("load",()=>document.documentElement.classList.add("loaded"));</script>  </body> </html> 